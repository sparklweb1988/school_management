{% extends 'dashboard/base.html' %}

{% block nav %}
<!-- Empty block to remove the navbar on the result report page -->
{% endblock nav %}

{% block content %}
<div class="container">

    <h1>Result Report</h1>
    <h2>School Name</h2>
    <h2>Terminal Examination Result</h2>
    <br><br>

    <!-- Filter Form -->
    <form method="get">
        {% if request.user.is_superuser or request.user.role in 'admin teacher' %}
        <label>Student:</label>
        <select name="student">
            <option value="">All</option>
            {% for student in students %}
            <option value="{{ student.id }}"
                {% if selected_student == student.id|stringformat:"s" %}selected{% endif %}>
                {{ student.user_profile.username }}
            </option>
            {% endfor %}
        </select>

        <label>Class:</label>
        <select name="class">
            <option value="">All</option>
            {% for cls in classes %}
            <option value="{{ cls.id }}" {% if selected_class == cls.id|stringformat:"s" %}selected{% endif %}>
                {{ cls.name }}
            </option>
            {% endfor %}
        </select>
        {% endif %}

        <label>Session:</label>
        <select name="session">
            <option value="">All</option>
            {% for session in sessions %}
            <option value="{{ session }}" {% if selected_session == session %}selected{% endif %}>{{ session }}
            </option>
            {% endfor %}
        </select>

        <label>Term:</label>
        <select name="term">
            <option value="">All</option>
            {% for term in terms %}
            <option value="{{ term.id }}" {% if selected_term == term.id %}selected{% endif %}>{{ term.name }}
            </option>
            {% endfor %}
        </select>
        <br><br>
        <button type="submit" class='primary'>Filter</button>
        <button type="button" class='primary' onclick="window.print()">Print PDF</button>
    </form>

    <br><br>

    <table class='styled-table'>
        <thead>
            <tr>
                <th>School</th>
                <th>Student</th>
                <th>Class</th>
                <th>Subject</th>
                <th>Test 1</th>
                <th>Test 2</th>
                <th>Exam</th>
                <th>Total</th>
                <th>Session</th>
                <th>Term</th>
            </tr>
        </thead>
        <tbody>
            {% for result in results %}
            <tr>
                <td>{{ result.student.school_class.school.name }}</td>
                <td>{{ result.student.user_profile.username }}</td>
                <td>{{ result.student.school_class.name }}</td>
                <td>{{ result.subject.name }}</td>
                <td>{{ result.test_1 }}</td>
                <td>{{ result.test_2 }}</td>
                <td>{{ result.exam }}</td>
                <td>{{ result.Total }}</td>
                <td>{{ result.session }}</td>
                <td>{{ result.term }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="10">No results found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <br>
    <td>
        <a href="{% url 'result_list'%}" class="btn view">Go Back</a>
    </td>
</div>
{% endblock content %}